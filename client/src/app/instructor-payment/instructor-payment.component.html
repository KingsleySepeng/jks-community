<div class="payment-container">
  <h2>Log Cash Payment (Instructor Only)</h2>

  <p><strong>Instructor:</strong> {{ currentInstructor?.firstName }} {{ currentInstructor?.lastName }}</p>

  <form (ngSubmit)="onSubmitPayment()">
    <!-- Select Student -->
    <div class="form-group">
      <label for="student">Select Student:</label>
      <select id="student" [(ngModel)]="selectedStudentId" name="student" required>
        <option value="">--Select Student--</option>
        <option *ngFor="let s of students" [value]="s.id">
          {{ s.firstName }} {{ s.lastName }} [ID: {{ s.id }}]
        </option>
      </select>
    </div>

    <!-- Select Event (Optional) -->
    <div class="form-group">
      <label for="event">Select Event (Optional):</label>
      <select id="event" [(ngModel)]="selectedEventId" name="event" (change)="onEventChange()">
        <option value="">--No Event--</option>
        <option *ngFor="let event of events" [value]="event.id">
          {{ event.eventName }} - ${{ event.cost }}
        </option>
      </select>
    </div>

    <!-- Payment Amount -->
    <div class="form-group">
      <label for="amount">Amount ($):</label>
      <input id="amount" type="number" [(ngModel)]="amount" name="amount" required />
    </div>

    <!-- Payment Type -->
    <div class="form-group">
      <label for="paymentType">Payment Type:</label>
      <select id="paymentType" [(ngModel)]="paymentType" name="paymentType" required>
        <option value="Class Fee">Class Fee</option>
        <option value="Affiliation">Affiliation</option>
        <option value="Event Registration">Event Registration</option>
        <option value="Other">Other</option>
      </select>
    </div>

    <!-- Payment Description -->
    <div class="form-group">
      <label for="description">Description:</label>
      <textarea id="description" [(ngModel)]="description" name="description"
                placeholder="e.g., Class fees for Jan and Feb" required></textarea>
    </div>

    <button type="submit">Log Payment</button>
  </form>

  <!-- Payment History -->
  <h3>Payment History</h3>
  <table class="table">
    <thead>
    <tr>
      <th>Student</th>
      <th>Amount</th>
      <th>Type</th>
      <th>Date</th>
      <th>Actions</th>
    </tr>
    </thead>
    <tbody>
    <tr *ngFor="let payment of paymentHistory">
      <td>{{ payment.reference }}</td>
      <td>${{ payment.amount }}</td>
      <td>{{ payment.paymentType }}</td>
      <td>{{ payment.paymentDate | date: 'medium' }}</td>
      <td>
        <button (click)="downloadInvoice(payment)">Download Invoice</button>
      </td>
    </tr>
    </tbody>
  </table>

  <p class="message" *ngIf="message">{{ message }}</p>
</div>
